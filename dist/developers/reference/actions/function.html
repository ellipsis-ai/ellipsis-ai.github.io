<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Ellipsis · Get work done in chat by ellipsis-ai</title>

    <link rel="stylesheet" href="/assets/css/style.css?v=ed781f0c570287fccb2d3eaaf8a5c246c1a9715d">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Ellipsis · Get work done in chat</h1>
        <p>Ellipsis documentation.
</p>

        
          <p class="view"><a href="http://github.com/ellipsis-ai/ellipsis-ai.github.io">View the Project on GitHub <small></small></a></p>
        

        

        
      </header>
      <section>

      <h1 id="nodejs-function">Node.js function</h1>

<p><strong>Each action can run a single JavaScript function that performs a task or calculates something.</strong></p>

<p>The function should end by telling Ellipsis that it completed successfully (including any text or data you want to include in the <a href="/developers/reference/actions/template.html">response</a>), or else it can signal that an error occurred, or that there should be no response.</p>

<p>Adding a function is optional. If you want your action to return the same response every time, you don’t need to write any code.</p>

<p>Functions run in the Node.js environment (v6.10.2). That means you can use <a href="https://nodejs.org/dist/latest-v6.x/docs/api/">any documented feature of Node.js</a>, and you can also load other modules using the <code class="highlighter-rouge">require</code> feature – either <a href="../libraries/index.md">skill libraries</a>, or any <a href="https://www.npmjs.com/">NPM package</a>.</p>

<h2 id="function-parameters">Function parameters</h2>

<p>The function itself is always declared for you. It will automatically receive <a href="../ellipsis_object/index.md">an <code class="highlighter-rouge">ellipsis</code> object</a> as a parameter. If you’ve defined any <a href="/developers/reference/actions/inputs.html">inputs</a>, each of those will also be received as parameters. In other words, you only need to write the “inside” of the function.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ellipsis</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">// write your code here; it will execute when the action runs</span>
<span class="p">};</span>
</code></pre>
</div>

<h2 id="the-ellipsis-object-and-callback-methods">The <code class="highlighter-rouge">ellipsis</code> object and callback methods</h2>

<p>The <code class="highlighter-rouge">ellipsis</code> object includes callback methods you use to tell Ellipsis when your function has finished. <strong>You must call one of the methods to finish.</strong> (Using a simple <code class="highlighter-rouge">return</code> statement will not work.)</p>

<p>There are three callback methods:</p>

<ul>
  <li><code class="highlighter-rouge">ellipsis.success</code></li>
  <li><code class="highlighter-rouge">ellipsis.error</code></li>
  <li><code class="highlighter-rouge">ellipsis.noResponse</code></li>
</ul>

<p>Call <code class="highlighter-rouge">ellipsis.success()</code> when your function is finished and you want to send a response to the user that ran the action. Pass any text or data you want to include in the response.</p>

<p>Call <code class="highlighter-rouge">ellipsis.error()</code> when something has gone wrong and you want to send an error message.</p>

<p>Call <code class="highlighter-rouge">ellipsis.noResponse()</code> when you want to finish but send no response. This is typically useful for scheduled actions that you only want to respond in certain circumstances (e.g. an alert).</p>

<p>You will see an error message if your function runs without calling one of these methods.</p>

<p><code class="highlighter-rouge">ellipsis</code> contains other useful run-time properties, like information about the team and the user. <a href="../ellipsis_object/index.md">See the <code class="highlighter-rouge">ellipsis</code> object reference.</a></p>

<h2 id="examples">Examples</h2>

<h4 id="example-hello-world">Example: Hello world</h4>

<p>You can send a string you want to include in the response. Insert it into the <a href="/developers/reference/actions/template.html">response template</a> using the <code class="highlighter-rouge"><span class="p">{</span><span class="err">successResult</span><span class="p">}</span></code> placeholder.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ellipsis</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="nx">ellipsis</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="s2">"Hello world! 1 + 1 = "</span> <span class="o">+</span> <span class="nx">result</span><span class="p">);</span>
  <span class="c1">// Passes "Hello world! 1 + 1 = 2" to the response template</span>
<span class="p">};</span>
</code></pre>
</div>

<h4 id="example-the-current-date-and-time">Example: the current date and time</h4>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ellipsis</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="nx">ellipsis</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="nx">now</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
  <span class="c1">// Passes the current date and time (in UTC) as a string to the response template</span>
<span class="p">};</span>
</code></pre>
</div>

<h4 id="example-using-inputs-to-construct-a-response">Example: using inputs to construct a response</h4>

<p>In this example, two <a href="/developers/reference/actions/inputs.html">inputs</a> have been configured – <code class="highlighter-rouge">firstName</code> and
<code class="highlighter-rouge">lastName</code>, and it uses <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/template_strings">JavaScript’s template literal syntax</a> to format the text more easily.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">ellipsis</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="err">`</span><span class="nx">Hello</span><span class="p">,</span> <span class="nx">$</span><span class="p">{</span><span class="nx">firstName</span><span class="p">}</span> <span class="nx">$</span><span class="p">{</span><span class="nx">lastName</span><span class="p">}.</span>

<span class="nx">How</span> <span class="k">do</span> <span class="nx">you</span> <span class="k">do</span><span class="p">?</span><span class="err">`</span><span class="p">;</span>
  <span class="nx">ellipsis</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
  <span class="c1">// Use JavaScript's template literal syntax to combine text with variables</span>
<span class="p">};</span>
</code></pre>
</div>

<h4 id="example-sending-data-to-the-response-template">Example: sending data to the response template</h4>

<p>You can send data using a JSON-style object to the template instead of a string, and then insert each properties individually.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ellipsis</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">hour</span><span class="p">:</span> <span class="nx">now</span><span class="p">.</span><span class="nx">getHours</span><span class="p">(),</span>
    <span class="na">minute</span><span class="p">:</span> <span class="nx">now</span><span class="p">.</span><span class="nx">getMinutes</span><span class="p">()</span>
  <span class="p">};</span>
  <span class="nx">ellipsis</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

  <span class="c1">// The response template will receive an object with `hour` and `minute` properties.</span>
  <span class="c1">// Use {successResult.hour} and {successResult.minute} to insert the text in the template.</span>
<span class="p">};</span>
</code></pre>
</div>

<h4 id="example-sending-an-error-message">Example: Sending an error message</h4>

<p>When something goes wrong, signal that an error occurred and include an explanatory message.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ellipsis</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="kr">const</span> <span class="nx">day</span> <span class="o">=</span> <span class="nx">now</span><span class="p">.</span><span class="nx">getDay</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">day</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">day</span> <span class="o">===</span> <span class="mi">6</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ellipsis</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">"Sorry, this action can only be run on weekdays."</span><span class="p">);</span>
    <span class="c1">// Skips the response template, and sends an error message to the user.</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">ellipsis</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="s2">"Another day, another dollar."</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre>
</div>

<h4 id="example-sending-no-response">Example: sending no response</h4>

<p>If you want Ellipsis to remain silent in certain circumstances, you can signal that no response should occur.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ellipsis</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="kr">const</span> <span class="nx">day</span> <span class="o">=</span> <span class="nx">now</span><span class="p">.</span><span class="nx">getDay</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">day</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ellipsis</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="s2">"Looks like someone’s got a case of the Mondays!"</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">ellipsis</span><span class="p">.</span><span class="nx">noResponse</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre>
</div>

<h4 id="example-using-npm-packages">Example: using NPM packages</h4>

<p>You can <code class="highlighter-rouge">require</code> any NPM package by name. Ellipsis will install the latest version of the package for you automatically.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ellipsis</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">moment</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'moment-timezone'</span><span class="p">);</span> <span class="c1">// A useful package for dealing with dates/times</span>

  <span class="kr">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">().</span><span class="nx">tz</span><span class="p">(</span><span class="s1">'America/Los_Angeles'</span><span class="p">);</span>
  <span class="nx">ellipsis</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="nx">now</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s2">"h:mm A z"</span><span class="p">));</span>
  <span class="c1">// Passes the current time as a string for the Pacific time zone</span>
<span class="p">};</span>
</code></pre>
</div>


      </section>
      <footer>
        
        <p>This project is maintained by <a href="http://github.com/ellipsis-ai">ellipsis-ai</a></p>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>


  
  </body>
</html>
